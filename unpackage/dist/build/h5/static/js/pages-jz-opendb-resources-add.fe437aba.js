(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-jz-opendb-resources-add"],{"3d3c":function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return r}));var r={uniForms:a("8d1e").default,uniFormsItem:a("e076").default,uniEasyinput:a("aad2").default,yunmiaoCascader:a("a40d").default,uniDataCheckbox:a("3cfc").default,uniFilePicker:a("ea53").default},i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",{staticClass:"uni-container"},[a("uni-forms",{ref:"form",attrs:{value:e.formData,validateTrigger:"bind"}},[a("uni-forms-item",{attrs:{name:"title",label:"标题",required:!0}},[a("uni-easyinput",{attrs:{placeholder:"请输入标题",trim:"both"},model:{value:e.formData.title,callback:function(t){e.$set(e.formData,"title",t)},expression:"formData.title"}})],1),a("uni-forms-item",{attrs:{name:"author",label:"来源",required:!0}},[a("uni-easyinput",{attrs:{placeholder:"请输入来源",trim:"both"},model:{value:e.formData.author,callback:function(t){e.$set(e.formData,"author",t)},expression:"formData.author"}})],1),a("uni-forms-item",{attrs:{name:"categorieszw",label:"分类"}},[a("uni-easyinput",{attrs:{placeholder:"请选择分类",trim:"both"},on:{focus:function(t){arguments[0]=t=e.$handleEvent(t),e.opencategories.apply(void 0,arguments)}},model:{value:e.formData.categorieszw,callback:function(t){e.$set(e.formData,"categorieszw",t)},expression:"formData.categorieszw"}}),a("yunmiao-cascader",{ref:"cascader",attrs:{"select-value":e.formData.categories,"value-name":"flbm",cascaderData:e.cascaderData},on:{confirem:function(t){arguments[0]=t=e.$handleEvent(t),e.cascaderConfirem.apply(void 0,arguments)}}})],1),a("uni-forms-item",{attrs:{name:"labels",label:"标签"}},[a("uni-easyinput",{attrs:{placeholder:"多个标签以逗号隔开",trim:"both"},model:{value:e.formData.labels,callback:function(t){e.$set(e.formData,"labels",t)},expression:"formData.labels"}})],1),a("uni-forms-item",{attrs:{name:"article_status",label:"状态"}},[a("uni-data-checkbox",{attrs:{localdata:e.formOptions.article_status_localdata},model:{value:e.formData.article_status,callback:function(t){e.$set(e.formData,"article_status",t)},expression:"formData.article_status"}})],1),a("uni-forms-item",{attrs:{name:"avatar",label:"封面大图",required:!0}},[a("uni-file-picker",{attrs:{limit:"1","file-mediatype":"image","return-type":"array"},model:{value:e.formData.avatar,callback:function(t){e.$set(e.formData,"avatar",t)},expression:"formData.avatar"}})],1),a("uni-forms-item",{attrs:{name:"zy_gs",label:"资源类型"}},[a("uni-data-checkbox",{attrs:{localdata:e.formOptions.zy_gs_localdata},model:{value:e.formData.zy_gs,callback:function(t){e.$set(e.formData,"zy_gs",t)},expression:"formData.zy_gs"}})],1),a("uni-forms-item",{attrs:{name:"resources",label:"附件资源"}},[0==e.formData.zy_gs?[a("uni-file-picker",{attrs:{"file-mediatype":"image","return-type":"array"},model:{value:e.formData.resources,callback:function(t){e.$set(e.formData,"resources",t)},expression:"formData.resources"}})]:[a("uni-file-picker",{attrs:{"file-mediatype":"all",limit:1,"return-type":"array"},model:{value:e.formData.resources,callback:function(t){e.$set(e.formData,"resources",t)},expression:"formData.resources"}})]],2),a("uni-forms-item",{attrs:{name:"aliyun_dz",label:"外链"}},[a("uni-easyinput",{attrs:{placeholder:"请输入外链地址",trim:"both"},model:{value:e.formData.aliyun_dz,callback:function(t){e.$set(e.formData,"aliyun_dz",t)},expression:"formData.aliyun_dz"}})],1),a("uni-forms-item",{attrs:{name:"excerpt",label:"内容"}},[a("uni-easyinput",{attrs:{placeholder:"请输入内容",trim:"both"},model:{value:e.formData.excerpt,callback:function(t){e.$set(e.formData,"excerpt",t)},expression:"formData.excerpt"}})],1),a("uni-forms-item",{attrs:{name:"is_grant",label:"是否授权"}},[a("uni-data-checkbox",{attrs:{localdata:e.formOptions.is_grant_localdata},model:{value:e.formData.is_grant,callback:function(t){e.$set(e.formData,"is_grant",t)},expression:"formData.is_grant"}})],1),a("uni-forms-item",{attrs:{name:"is_encryption",label:"是否加密"}},[a("uni-data-checkbox",{attrs:{localdata:e.formOptions.is_encryption_localdata},model:{value:e.formData.is_encryption,callback:function(t){e.$set(e.formData,"is_encryption",t)},expression:"formData.is_encryption"}})],1),a("v-uni-view",{staticClass:"uni-button-group"},[a("v-uni-button",{staticClass:"uni-button",staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.submit.apply(void 0,arguments)}}},[e._v("提交")]),a("v-uni-navigator",{staticStyle:{"margin-left":"15px"},attrs:{"open-type":"navigateBack"}},[a("v-uni-button",{staticClass:"uni-button",staticStyle:{width:"100px"}},[e._v("返回")])],1)],1)],1)],1)},n=[]},4022:function(e,t,a){"use strict";var r=a("4ea4");a("4160"),a("c975"),a("d81d"),a("a9e3"),a("ac1f"),a("1276"),a("159b"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(a("5530")),n={name:"cascader",props:{activeIndex:{type:Number,default:0},cascaderShow:{type:Boolean,default:!1},oneSelect:{type:Boolean,default:!0},twoSelect:{type:Boolean,default:!0},labelName:{type:String,default:"name"},valueName:{type:String,default:"id"},selectValue:{type:[Array,String],default:function(){return[]}},cascaderData:{type:Array,default:function(){return[]}}},data:function(){return{current:this.activeIndex,showPop:this.cascaderShow,selectDataCopy:JSON.parse(JSON.stringify(this.cascaderData)),selectData:JSON.parse(JSON.stringify(this.cascaderData))}},watch:{cascaderData:function(e,t){this.selectData=JSON.parse(JSON.stringify(e))}},mounted:function(){this.defaultSelect()},methods:{defaultSelect:function(){var e=this,t=this.selectValue;"string"==typeof t&&(t=t.split(","));var a=this.selectData;function r(a){a.forEach((function(a,i){-1!=t.indexOf(a[e.valueName])?e.$set(a,"active",!0):e.$set(a,"active",!1),a.children&&a.children.length>0&&r(a.children)}))}a&&a.length>0&&r(a[0].children)},show:function(){this.showPop=!0,this.defaultSelect()},hide:function(){this.showPop=!1},checkboxChange:function(e,t){var a=this.selectData[t];a.active=e.value,this.$set(this.selectData,t,a)},selectOne:function(e){this.current=e},selectTwo:function(e,t){if(this.twoSelect){var a=this.selectData[this.current];if(a.children[t].active){a.children[t]=(0,i.default)((0,i.default)({},e),{},{active:!1});var r=!1;a.children.map((function(e){e.active&&(r=!0),e.children&&e.children.length>0&&e.children.map((function(e){e.active&&(r=!0)}))})),r||(a.child_active=!1)}else a.children[t]=(0,i.default)((0,i.default)({},e),{},{active:!0}),a.child_active=!0;this.$set(this.selectData,this.current,a)}},selectTree:function(e,t,a){var r=this.selectData[this.current],n=r.children[e];if(n.children[a].active){n.children[a]=(0,i.default)((0,i.default)({},t),{},{active:!1});var c=!1;n.children.map((function(e){e.active&&(c=!0)})),c||(n.child_active=!1);var l=!1;r.children.map((function(e){e.active&&(l=!0),e.children.map((function(e){e.active&&(l=!0)}))})),l||(r.child_active=!1)}else n.children[a]=(0,i.default)((0,i.default)({},t),{},{active:!0}),n.child_active=!0,r.child_active=!0;this.$set(this.selectData,this.current,r)},cancelSelect:function(){this.selectData=JSON.parse(JSON.stringify(this.selectDataCopy)),this.showPop=!1},confiremSelect:function(){var e=this,t=this.selectData,a=[],r=[];t.map((function(t,i){t.active&&(a.push(t[e.valueName]),r.push(t[e.labelName])),t.children&&t.children.length>0&&t.children.map((function(t,i){t.active&&(a.push(t[e.valueName]),r.push(t[e.labelName])),t.children&&t.children.length>0&&t.children.map((function(t,i){t.active&&(a.push(t[e.valueName]),r.push(t[e.labelName]))}))}))})),this.$emit("confirem",{select_ids:a,select_names:r}),this.showPop=!1}}};t.default=n},4941:function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return r}));var r={uPopup:a("3342").default,uIcon:a("1369").default},i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("u-popup",{attrs:{mode:"bottom"},model:{value:e.showPop,callback:function(t){e.showPop=t},expression:"showPop"}},[a("v-uni-view",{staticClass:"cascader-head"},[a("v-uni-text",{staticClass:"cancel",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.cancelSelect.apply(void 0,arguments)}}},[e._v("取消")]),a("v-uni-text",{staticClass:"title"},[e._v("请选择")]),a("v-uni-text",{staticClass:"confirem",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.confiremSelect.apply(void 0,arguments)}}},[e._v("确定")])],1),a("v-uni-view",{staticClass:"cascader"},[a("v-uni-scroll-view",{staticClass:"item",staticStyle:{"background-color":"white"},attrs:{"scroll-y":"true"}},[e.selectData.length>0&&e.selectData[e.current].children.length>0?e._l(e.selectData[e.current].children,(function(t,r){return a("v-uni-view",{key:r,staticClass:"item-cont"},[a("v-uni-view",{staticClass:"item-cate",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.selectTwo(t,r)}}},[a("v-uni-text",{staticClass:"title",style:{color:t.child_active?"#f44c01":"#333333"}},[e._v(e._s(t.name))]),t.active?a("u-icon",{attrs:{name:"checkmark",color:"#f44c01",size:"28"}}):e._e()],1),t.children&&t.children.length>0?a("v-uni-view",{staticClass:"item-cellbox"},e._l(t.children,(function(t,i){return a("v-uni-text",{key:i,staticClass:"item-cell",style:{color:t.active?"#ffffff":"#666666",background:t.active?"red":"#f8f8f8"},on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.selectTree(r,t,i)}}},[e._v(e._s(t.name))])})),1):e._e()],1)})):e._e()],2)],1)],1)],1)},n=[]},5149:function(e,t,a){"use strict";var r=a("c21c"),i=a.n(r);i.a},"968f":function(e,t,a){"use strict";a.r(t);var r=a("4022"),i=a.n(r);for(var n in r)"default"!==n&&function(e){a.d(t,e,(function(){return r[e]}))}(n);t["default"]=i.a},a40d:function(e,t,a){"use strict";a.r(t);var r=a("4941"),i=a("968f");for(var n in i)"default"!==n&&function(e){a.d(t,e,(function(){return i[e]}))}(n);a("5149");var c,l=a("f0c5"),s=Object(l["a"])(i["default"],r["b"],r["c"],!1,null,"3ded5ba2",null,!1,r["a"],c);t["default"]=s.exports},a43c:function(e,t,a){"use strict";var r=a("4ea4");a("4d63"),a("ac1f"),a("25f0"),Object.defineProperty(t,"__esModule",{value:!0}),t.filterToWhere=s,t.enumConverter=t.validator=void 0;var i=r(a("3835")),n=r(a("b85c")),c={title:{rules:[{required:!0},{format:"string"}],label:"标题"},author:{rules:[{required:!0},{format:"string"}],label:"作者"},categories:{rules:[{format:"string"}],label:"分类"},categorieszw:{rules:[{format:"string"}],label:"分类中文"},labels:{rules:[{format:"string"}],label:"标签"},article_status:{rules:[{format:"int"},{range:[{value:0,text:"锁定"},{value:1,text:"启用"}]}],defaultValue:0,label:"文章状态"},avatar:{rules:[{format:"array"},{arrayType:"file"}],label:"封面大图"},zy_gs:{rules:[{format:"int"},{range:[{value:0,text:"图片"},{value:1,text:"视频"},{value:2,text:"音乐"},{value:3,text:"文章"}]}],defaultValue:0,label:"资源类型"},resources:{rules:[{format:"array"},{arrayType:"file"}],label:"附件资源"},aliyun_dz:{rules:[{format:"string"}],label:"外链"},excerpt:{rules:[{format:"string"}],label:"内容"},is_grant:{rules:[{format:"int"},{range:[{value:0,text:"未授权"},{value:1,text:"已授权"}]}],defaultValue:0,label:"是否授权"},is_encryption:{rules:[{format:"int"},{range:[{value:0,text:"不加密"},{value:1,text:"加密"}]}],defaultValue:0,label:"是否加密"}};t.validator=c;var l={article_status_valuetotext:{0:"锁定",1:"启用"},zy_gs_valuetotext:{0:"图片",1:"视频",2:"音乐",3:"文章"},is_grant_valuetotext:{0:"未授权",1:"已授权"},is_encryption_valuetotext:{0:"不加密",1:"加密"}};function s(e,t){var a={};for(var r in e){var c=e[r],l=c.type,s=c.value;switch(l){case"search":"string"===typeof s&&s.length&&(a[r]=new RegExp(s));break;case"select":if(s.length){var o,u=[],d=(0,n.default)(s);try{for(d.s();!(o=d.n()).done;){var f=o.value;u.push(t.eq(f))}}catch(w){d.e(w)}finally{d.f()}a[r]=t.or(u)}break;case"range":if(s.length){var m=s[0],v=s[1];a[r]=t.and([t.gte(m),t.lte(v)])}break;case"date":if(s.length){var h=(0,i.default)(s,2),p=h[0],b=h[1],g=new Date(p),y=new Date(b);a[r]=t.and([t.gte(g),t.lte(y)])}break;case"timestamp":if(s.length){var _=(0,i.default)(s,2),x=_[0],D=_[1];a[r]=t.and([t.gte(x),t.lte(D)])}break}}return a}t.enumConverter=l},a8b6:function(e,t,a){var r=a("24fb");t=r(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */\r\n/***字体大小规范***/\r\n/***颜色定义***/\r\n/***行间距***/.cascader-head[data-v-3ded5ba2]{height:%?100?%;display:flex;flex-direction:row;align-items:center;justify-content:space-between;padding:0 %?30?%;border-bottom:%?1?% solid #e6e6e6}.cascader-head .cancel[data-v-3ded5ba2]{font-size:%?30?%;color:#666}.cascader-head .title[data-v-3ded5ba2]{font-size:%?30?%;color:#333}.cascader-head .confirem[data-v-3ded5ba2]{font-size:%?30?%;color:#666}.cascader[data-v-3ded5ba2]{display:flex;flex-direction:row;height:%?800?%;background-color:#f8f8f8}.cascader .item[data-v-3ded5ba2]{height:%?800?%}.cascader .item .item-block[data-v-3ded5ba2]{display:flex;flex-direction:row;align-items:center;height:%?100?%;padding:%?20?%;font-size:%?26?%;color:#333}.cascader .item .item-list[data-v-3ded5ba2]{display:flex;flex-direction:row;align-items:center;height:%?100?%;border-bottom:%?1?% solid #e6e6e6;padding:0 %?20?%}.cascader .item .item-cont[data-v-3ded5ba2]{display:flex;flex-direction:column;padding:%?20?%}.cascader .item .item-cont .item-cate[data-v-3ded5ba2]{border-bottom:%?1?% solid #e6e6e6;padding:%?20?% 0;display:flex;flex-direction:row;align-items:center;justify-content:space-between}.cascader .item .item-cont .item-cate .title[data-v-3ded5ba2]{font-size:%?26?%;color:#333}.cascader .item .item-cont .item-cellbox[data-v-3ded5ba2]{display:flex;flex-direction:row;align-items:center;flex-wrap:wrap}.cascader .item .item-cont .item-cellbox .item-cell[data-v-3ded5ba2]{width:%?150?%;height:%?60?%;display:flex;flex-direction:row;align-items:center;justify-content:center;background-color:#f8f8f8;margin-right:%?15?%;font-size:%?25?%;color:#666;margin-top:%?20?%;border-radius:%?10?%}.cascader .item .item-cont .active[data-v-3ded5ba2]{color:"#ffffff";background:"#fa3534"}',""]),e.exports=t},aabf:function(e,t,a){"use strict";(function(e){var r=a("4ea4");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("96cf");var i=r(a("1da1")),n=e.database(),c={data:function(){return{categorieszw:"",cascaderData:[]}},watch:{},onReady:function(){this.getcategories()},methods:{getcategories:function(){var e=this;return(0,i.default)(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,n.collection("opendb-news-categories").get({getTree:{startWith:"flbm=='100000'"}});case 2:a=t.sent,console.log("categories",a),a.result&&a.result.data.length>0&&(e.cascaderData=a.result.data);case 5:case"end":return t.stop()}}),t)})))()},cascaderConfirem:function(e){console.log("eee",e);var t=e.select_names,a=e.select_ids;this.$set(this.formData,"categories",a.join(",")),this.$set(this.formData,"categorieszw",t.join(","))},opencategories:function(){this.$refs.cascader.show()}}};t.default=c}).call(this,a("a9ff")["default"])},b557:function(e,t,a){"use strict";(function(e){var r=a("4ea4");a("caad"),a("b64b"),a("d3b7"),a("2532"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(a("5530")),n=a("a43c"),c=r(a("aabf")),l=r(a("a40d")),s=e.database(),o=(s.command,"jz-opendb-resources");function u(e){var t={};for(var a in n.validator)e.includes(a)&&(t[a]=n.validator[a]);return t}var d={mixins:[c.default],components:{yunmiaoCascader:l.default},data:function(){var e={title:"",author:"",categories:"",categorieszw:"",labels:"",article_status:0,avatar:null,zy_gs:0,resources:[],aliyun_dz:"",excerpt:"",is_grant:0,is_encryption:0};return{formData:e,formOptions:{article_status_localdata:[{value:0,text:"锁定"},{value:1,text:"启用"}],zy_gs_localdata:[{value:0,text:"图片"},{value:1,text:"视频"},{value:2,text:"音乐"},{value:3,text:"文章"}],is_grant_localdata:[{value:0,text:"未授权"},{value:1,text:"已授权"}],is_encryption_localdata:[{value:0,text:"不加密"},{value:1,text:"加密"}]},rules:(0,i.default)({},u(Object.keys(e)))}},onReady:function(){this.$refs.form.setRules(this.rules)},methods:{submit:function(){var e=this;uni.showLoading({mask:!0}),this.$refs.form.validate().then((function(t){return e.submitForm(t)})).catch((function(){})).finally((function(){uni.hideLoading()}))},submitForm:function(e){var t=this;return Object.assign(e,{user_id:s.getCloudEnv("$cloudEnv_uid"),categories:this.formData.categories}),s.collection(o).add(e).then((function(e){uni.showToast({title:"新增成功"}),t.getOpenerEventChannel().emit("refreshData"),setTimeout((function(){return uni.navigateBack()}),500)})).catch((function(e){uni.showModal({content:e.message||"请求服务失败",showCancel:!1})}))}}};t.default=d}).call(this,a("a9ff")["default"])},c21c:function(e,t,a){var r=a("a8b6");"string"===typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);var i=a("4f06").default;i("0519b632",r,!0,{sourceMap:!1,shadowMode:!1})},d1e0:function(e,t,a){"use strict";a.r(t);var r=a("b557"),i=a.n(r);for(var n in r)"default"!==n&&function(e){a.d(t,e,(function(){return r[e]}))}(n);t["default"]=i.a},e6f9:function(e,t,a){"use strict";a.r(t);var r=a("3d3c"),i=a("d1e0");for(var n in i)"default"!==n&&function(e){a.d(t,e,(function(){return i[e]}))}(n);var c,l=a("f0c5"),s=Object(l["a"])(i["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],c);t["default"]=s.exports}}]);